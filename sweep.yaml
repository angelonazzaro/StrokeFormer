
program: train_strokeformer.py
project: StrokeFormer
entity: neurone-lab
name: SegFormer3D-dynamic-ici-loss
method: bayes
metric:
  goal: minimize
  name: val_loss
parameters:
  model.lr:
    distribution: log_uniform_values
    min: 0.00001         # 1e-5
    max: 0.001           # 1e-3
  model.init_lr:
    distribution: log_uniform_values
    min: 0.000001        # 1e-6
    max: 0.00005         # 5e-5
  model.weight_decay:
    distribution: log_uniform_values
    min: 0.00001         # 1e-5
    max: 0.01            # 1e-2
  model.warmup_steps:
    distribution: int_uniform
    min: 5
    max: 50
  model.loss_weights:
    values:
      - [0.5, 0.5]
      - [0.75, 0.25]
      - [0.9, 0.1]
      - [1.0, 0.0]
  data.paths:
    value:
      train:
        scans: "data/ATLAS_2/Processed/Splits/Train/Scans"
        masks: "data/ATLAS_2/Processed/Splits/Train/Masks"
      val:
        scans: "data/ATLAS_2/Processed/Splits/Val/Scans"
        masks: "data/ATLAS_2/Processed/Splits/Val/Masks"
  data.batch_size:
    value: 8
  trainer.max_epochs:
    value: 150
early_terminate:
  type: hyperband
  eta: 3
  min_iter: 1
  max_iter: 10

command:
  - python
  - ${program}
  - fit
  - --config
  - strokeformer_config.yaml
  - ${args}