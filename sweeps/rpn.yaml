program: train_rpn.py
project: RPN
entity: neurone-lab
name: truenet-pretrained-rpn-sweep-multiple-sessions
method: bayes
metric:
  goal: minimize
  name: val_loss
parameters:
  model.backbone_lr:
    distribution: log_uniform_values
    min: 0.00001         # 1e-6
    max: 0.001           # 1e-4
  model.roi_head_lr:
    distribution: log_uniform_values
    min: 0.00001         # 1e-4
    max: 0.001           # 1e-2
  model.rpn_lr:
    distribution: log_uniform_values
    min: 0.00001         # 1e-4
    max: 0.001           # 1e-2
  model.weight_decay:
    distribution: log_uniform_values
    min: 0.00001         # 1e-5
    max: 0.01            # 1e-2
  data.paths:
    value:
      train:
        scans: "data/ATLAS_2/Processed/Base/2D/Balanced/MultipleSessions/Splits/Train/Scans"
        masks: "data/ATLAS_2/Processed/Base/2D/Balanced/MultipleSessions/Splits/Train/Masks"
      val:
        scans: "data/ATLAS_2/Processed/Base/2D/Balanced/MultipleSessions/Splits/Val/Scans"
        masks: "data/ATLAS_2/Processed/Base/2D/Balanced/MultipleSessions/Splits/Val/Masks"
  data.batch_size:
    value: 32
  trainer.max_epochs:
    value: 50
early_terminate:
  type: hyperband
  eta: 3
  min_iter: 1
  max_iter: 10

command:
  - python
  - ${program}
  - fit
  - --config
  - configs/rpn.yaml
  - ${args}